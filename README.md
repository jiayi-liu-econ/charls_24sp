# charls_24sp

## Computational Requirements:
	- R 4.3.2 but other versions should be able to run the code. 
	- At least 130 MB of free disk space are recommended to download and process the data. 
	- Wall-clock time: less than 1hr in a Thinkpad X1 Carbon. 

## Data Availability Statement

The data sources used in the replication package can be found in China Health and Retirement Longitudinal Study (CHARLS) http://charls.pku.edu.cn/en/. In this project, I use Wave 2020 in particular, which can be downloaded via https://charls.charlsdata.com/pages/Data/2020-charls-wave5/en.html. The "charls2013stata_psu_psu编码.dta" file I use to get the province information can be downloaded in Wave 2013 via https://charls.charlsdata.com/pages/Data/2013-charls-wave2/en.html. You may need to register for free first and wait for approval to download the dataset, which should take less than 5 workdays.

## Data Files and Code (Structure and Explanation)
### Data Preparation
 "data20_prep.csv" are generated by running "dataprep.r". The task here is to merge the variables needed from "Demographic_Background.dta" (which produces "demo20.dta"), "charls2013stata_psu_psu编码.dta" (which produces "prov.dta"), "Household_Income.dta" (which produces "house20.dta"), "Work_Retirement.dta", "Health_Status_and_Functioning.dta", and "COVID_Module.dta". I also dropped missing observations for the variables from demographic information. (17,670 observations left) For the other variables, I kept the missing values. (Thus, when doing regressions, you may find the actual observations to be less than 17,670).

 Note: this is a semi-finished project, so there are some data files not used in "./data/raw" this time but intended to be used in the future.

 The dataset I generated is at individual level, with only one cross-section (Wave 2020).

 ### Data Description
 "data20_desc.csv" are generated by running "datadesc.r". The task is to further clean  "data20_prep.csv" and do some descriptive analysis. There are two figures (i.e., "boxplot_expenses.pdf", "histogram_expensemi.pdf") and one table (i.e., "sum.pdf") drawed here.

 ### Analysis (Fixed Effect Regressions)
I did some exploratory analysis here. I investigated how different medical insurance types (i.e., UEMI, URRMI, URMI, NCMI, PMI, OtherMI) would impact individuals' self-reported health status and life satisfaction. The output table is "feols.md".

## Code Execution 
You should be able to replicate the figures and tables by running "main.r". The only one unit test "test1.r" should be passed after the full execution of "main.r" (i.e., after the models in "./output/models" are generated.) You can rename all the files in the output folder first so as to distinguish between the files you reproduce and the original ones.

## Other Supporting Infomation
I attached the codebook "CHARLS_2020_Codebook.pdf" to the package. You can refer to it when you need additional information about the variables' definitions.
